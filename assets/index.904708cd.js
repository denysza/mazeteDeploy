var K=Object.defineProperty,G=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var M=(a,u,l)=>u in a?K(a,u,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[u]=l,R=(a,u)=>{for(var l in u||(u={}))Q.call(u,l)&&M(a,l,u[l]);if(H)for(var l of H(u))X.call(u,l)&&M(a,l,u[l]);return a},q=(a,u)=>G(a,U(u));import{u as j,r,v as Y,a as N,j as e,b as c,A as Z,T as V,c as ee,d as te,F as P,e as ae,B as ue,R as se,f as O,g as re,h as ie}from"./vendor.138df582.js";const ne=function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const v of t.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&d(v)}).observe(document,{childList:!0,subtree:!0});function l(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(o){if(o.ep)return;o.ep=!0;const t=l(o);fetch(o.href,t)}};ne();const le="https://mazete-api-dev.pechakucha.ai";function oe(){const a=j();return r.exports.useEffect(()=>{let u=Y();var l=JSON.stringify({register_id:u}),d={method:"post",url:`${le}/register_id`,headers:{"Content-Type":"application/json"},data:l};N(d).then(o=>{localStorage.setItem("register_id",u)}).catch(o=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}),e("div",{className:"container",children:c("div",{className:"container-wrap",children:[e("div",{className:"top-header",children:e("h1",{children:"\u30DE\u305C\u3066"})}),c("div",{className:"top-banner",children:[e("img",{src:"/assets/image/top-banner-img01.png",alt:"",className:"top-banner01"}),e("img",{src:"/assets/image/top-banner-img02.png",alt:"",className:"top-banner02"}),e("img",{src:"/assets/image/top-banner-img03.png",alt:"",className:"top-banner03"}),e("img",{src:"/assets/image/top-banner-img04.png",alt:"",className:"top-banner04"}),e("div",{className:"top-banner-text",children:"\u203B\u30B5\u30FC\u30D3\u30B9\u5185\u5BB9\u4F1D\u308F\u308B\u30A4\u30E9\u30B9\u30C8\u5916\u6CE8"})]}),e("a",{href:"/select",className:"start-btn",children:"\u30B9\u30BF\u30FC\u30C8"}),e("div",{className:"top-banner-border"}),c("div",{className:"top-delusion",children:[e("div",{className:"top-delusion-title",children:"\u307F\u3093\u306A\u306E\u5984\u60F3"}),c("div",{className:"top-delusion-body",children:[e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img01.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img02.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img03.png",alt:"",className:"top-delusion-img"})}),e("div",{className:"top-delusion-part",children:e("img",{src:"/assets/image/top-delusion-img04.png",alt:"",className:"top-delusion-img"})})]})]})]})})}const w="https://mazete-api-dev.pechakucha.ai",ce=ee({stringify:a=>a.kana+a.label});function de(){const a=j(),[u,l]=r.exports.useState(1),[d,o]=r.exports.useState([]),[t,v]=r.exports.useState(null),[F,T]=r.exports.useState(!1),[B,k]=r.exports.useState([]),[$,S]=r.exports.useState([]),[p,b]=r.exports.useState([]),[C,A]=r.exports.useState([]),[E,y]=r.exports.useState([]),[L,h]=r.exports.useState(null);r.exports.useEffect(()=>{let i=window.innerHeight;document.getElementById("character_select").style.height=i+"px";let n=localStorage.register_id||null;n||window.location.assign("/");let g=JSON.stringify({user_id:n,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),s={method:"post",url:`${w}/get_chara_list`,headers:{"Content-Type":"application/json"},data:g};N(s).then(_=>{k(_.data.chara_list)}).catch(_=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let m=JSON.stringify({user_id:n,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),D={method:"post",url:`${w}/get_world_list`,headers:{"Content-Type":"application/json"},data:m};N(D).then(_=>{S(_.data.world_list)}).catch(_=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})});let f={method:"post",url:`${w}/get_autocomplete_chara`,headers:{"Content-Type":"application/json"},data:{}};N(f).then(_=>{A(_.data.auto_complete),y(_.data.auto_complete)}).catch(_=>{});let x={method:"post",url:`${w}/get_autocomplete_world`,headers:{"Content-Type":"application/json"},data:{}};N(x).then(_=>{b(_.data.auto_complete)}).catch(_=>{})},[]),r.exports.useEffect(()=>{t&&d.length>0&&T(!0)},[d,t]);const z=i=>{let n=d,g=B.filter(s=>s.chara_id==i)[0];if(n.map(s=>s.chara_id).includes(i)){for(let s=0;s<n.length;s++)n[s].chara_id===i&&(n.splice(s,1),s--);o([...n])}else n.length<3&&(n.push(g),o([...n]))},J=()=>{let i=localStorage.register_id||null,n=JSON.stringify({user_id:i,chosen_chara_ids:d.map(s=>s.chara_id).toString(),chosen_world_ids:[t.world_id].toString()}),g={method:"post",url:`${w}/generate_outline`,headers:{"Content-Type":"application/json"},data:n};N(g).then(s=>{localStorage.setItem("outline_id",s.data.outline_id),localStorage.setItem("background",t.img_url),localStorage.setItem("user_list",JSON.stringify(d.map(m=>m.img_url))),window.location.assign("/synopsis")}).catch(s=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},I=i=>{i.preventDefault();let n=localStorage.register_id||null,g=L,s=d.map(f=>f.chara_id).toString(),m="";t&&(m=[t.world_id].toString());let D=JSON.stringify({user_id:n,search_query:g,chosen_chara_ids:s,chosen_world_ids:m});if(u==1){let f={method:"post",url:`${w}/get_chara_list`,headers:{"Content-Type":"application/json"},data:D};N(f).then(x=>{k(x.data.chara_list)}).catch(x=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}else{let f={method:"post",url:`${w}/get_world_list`,headers:{"Content-Type":"application/json"},data:D};N(f).then(x=>{S(x.data.world_list)}).catch(x=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}};return c("div",{className:"container",id:"character_select",children:[c("div",{className:"container-wrap",children:[c("div",{className:"preview",children:[c("div",{className:"preview-part",onClick:()=>{l(1),y(C),h(null)},children:[c("div",{className:"preview-img-part",children:[d.map(i=>e("img",{src:i.img_url,alt:""},i.chara_id)),d.length==0&&e("img",{src:"/assets/image/default-avatar.png"})]}),e("div",{className:u===1?"preview-title-part active":"preview-title-part",children:"\u30AD\u30E3\u30E9"})]}),c("div",{className:"preview-part",onClick:()=>{l(2),y(p),h(null)},children:[e("div",{className:"preview-img-part",children:e("img",{src:t!=null?t.img_url:"/assets/image/point-bg.png",alt:""})}),e("div",{className:u===2?"preview-title-part active":"preview-title-part",children:"\u4E16\u754C"})]})]}),c("div",{className:"point-select",children:[e("div",{className:"point-search",children:c("form",{onSubmit:I,children:[e(Z,{value:L,onChange:(i,n)=>{typeof n=="string"?h({label:n}):n&&n.inputValue?h({label:n.inputValue}):h(n)},filterOptions:(i,n)=>ce(i,n),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:E,getOptionLabel:i=>typeof i=="string"?i:i.label,renderOption:(i,n)=>e("li",q(R({},i),{children:n.label})),renderInput:i=>e(V,q(R({},i),{label:""}))}),e("button",{className:"search-btn",children:e("img",{src:"/assets/image/point-search.png",alt:""})})]})}),c("div",{className:"point-body",children:[u===1&&e("div",{className:"point-body-wrap",children:B.map((i,n)=>e("div",{style:{backgroundImage:`url(${i.img_url})`},onClick:()=>z(i.chara_id),className:`${d.map(g=>g.chara_id).includes(i.chara_id)?"active":""} character-item`,children:e("span",{})},n))}),u==2&&e("div",{className:"point-body-wrap",children:$.map((i,n)=>e("div",{style:{backgroundImage:`url(${i.img_url})`},className:`${(t==null?void 0:t.img_url)==i.img_url?"active":""} location-item`,onClick:g=>{v(i)},children:e("span",{})},n))})]})]})]}),e("button",{onClick:J,className:`character-add-btn ${F?"active":""}`,disabled:!F,children:"\u30DE\u305C\u308B"})]})}const W="https://mazete-api-dev.pechakucha.ai";function pe(){const a=j(),u=r.exports.useRef(),[l,d]=r.exports.useState(!1),[o,t]=r.exports.useState(!0),[v,F]=r.exports.useState(`\u30D3\u30EB\u306E\u5C4B\u4E0A\u306B\u3042\u3064\u3081\u3089\u308C\u305F\u30B4\u30F3\u9054\u3002

\u5229\u6839\u5DDD\u304B\u3089\u9244\u9AA8\u306E\u4E0A\u3092\u6E21\u3063\u3066\u3001\u5411\u3053\u3046\u306E\u30D3\u30EB\u3078\u884C\u3051\u305F\u3082\u306E\u306B\u8CDE\u91D1\u304C\u3082\u3089\u3048\u308B\u3068\u8AAC\u660E\u3092\u53D7\u3051\u308B\u3002

\u30B4\u30F3\u9054\u306F\u3044\u304B\u306B\u3057\u3066\u3053\u306E\u5371\u6A5F\u3092\u4E57\u308A\u8D8A\u3048\u308B\u306E\u304B\uFF1F`),[T,B]=r.exports.useState([]),[k,$]=r.exports.useState(null);r.exports.useEffect(()=>{let p=window.innerHeight;document.getElementById("loading_synposis").style.height=p+"px";let b=localStorage.register_id||null,C=localStorage.outline_id||null,A=localStorage.background||null,E=localStorage.user_list||null;console.log(E,A),(!E||!A)&&a("/select",{state:{}}),$(A),B(JSON.parse(E));let y=JSON.stringify({user_id:b,outline_id:C}),L={method:"post",url:`${W}/get_outline`,headers:{"Content-Type":"application/json"},data:y};N(L).then(h=>{h.data.generated&&h.data.outline&&!h.data.error?(t(!1),F(h.data.outline)):a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(h=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]);const S=()=>{let p=localStorage.register_id||null,b=localStorage.outline_id||null,C=JSON.stringify({user_id:p,outline_id:b,outline:v}),A={method:"post",url:`${W}/generate_story`,headers:{"Content-Type":"application/json"},data:C};N(A).then(E=>{window.location.assign(`/talk/${E.data.story_id}`)}).catch(E=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return r.exports.useEffect(()=>{u.current&&l&&u.current.focus()},[l]),c("div",{className:"container",id:"loading_synposis",children:[c("div",{className:"container-wrap",children:[e("div",{className:`ls-top ${l?"editing":""}`,children:e("div",{className:"",style:{backgroundImage:`url(${k}`,backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:e("div",{className:"ls-top-body",children:T.map((p,b)=>e("div",{className:"ls-top-item",children:e("img",{src:p,alt:""})},b))})})}),c("div",{className:"ls-main",children:[e("div",{className:"ls-main-title",children:"\u3042\u3089\u3059\u3058"}),c("div",{className:"ls-main-loading-text",children:[o&&c("div",{className:"ls-main-loading-part",children:[e("img",{src:"/assets/image/white-loading.gif",alt:""}),e("span",{children:"\u4E0B\u66F8\u304D\u6E96\u5099\u4E2D"})]}),!o&&e("textarea",{ref:u,className:"ls-main-loading-wrap",value:v,disabled:!l,onChange:p=>{F(p.target.value)},onBlur:()=>{d(!1)}})]}),!l&&c("a",{className:"ls-main-edit-btn",onClick:()=>{u.current.focus(),d(!0)},children:[e("span",{children:"\u7DE8\u96C6"}),e("img",{src:"/assets/image/edit-icon.png",alt:""})]})]})]}),!l&&e("button",{onClick:S,className:o?"ls-main-making-btn":"ls-main-making-btn active",disabled:o,children:"\u3053\u306E\u4E16\u754C\u7DDA\u306B\u5165\u308B"})]})}const ge="https://mazete-api-dev.pechakucha.ai";function me(a){return new Promise(u=>setTimeout(u,a))}function he(){const[a,u]=r.exports.useState([0,0]);return r.exports.useLayoutEffect(()=>{function l(){u([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",l),l(),()=>window.removeEventListener("resize",l)},[]),a}function fe(){const a=j(),[u,l]=r.exports.useState(!0),[d,o]=r.exports.useState(null),[t,v]=r.exports.useState(0),[F,T]=r.exports.useState(null),[B,k]=r.exports.useState(null),[$,S]=r.exports.useState([]),[p,b]=r.exports.useState(!1),[C,A]=r.exports.useState(!1),[E,y]=r.exports.useState(!1),[L,h]=he();let{story_id:z}=te();r.exports.useEffect(()=>{let s=localStorage.register_id||null,m=JSON.stringify({user_id:s,story_id:z}),D={method:"post",url:`${ge}/get_story`,headers:{"Content-Type":"application/json"},data:m};N(D).then(f=>{l(!1),f.data.generated&&!f.data.error?(l(!1),o(f.data)):a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(f=>{a("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]),r.exports.useEffect(()=>{d&&J()},[d,t]);const J=()=>{let s=d.story;k(s[t].chara_img_url),T(s[t].position),s[t].multiple?(b(!0),S(s[t].content)):(b(!1),I(s[t].content))},I=async s=>{y(!0);for(var m=0;m<s.length;)S([s.substring(0,m+1)]),m++,await me(75);y(!1),d.story.length-1==t&&A(!0)},i=s=>{p&&(b(!1),I(s))},n=()=>{!E&&!p&&d.story.length-1>t&&v(t+1)},g=()=>{console.log(t),t===0&&a("/synopsis",{state:{}}),t!=0&&!E&&(v(t-1),A(!1))};return c(P,{children:[u&&c("div",{className:"container",id:"loading_adventure",children:[e("div",{className:"container-wrap",children:c("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})}),e("button",{className:"back-to-btn",onClick:g,children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})})]}),!u&&c("div",{className:"container",id:"adventure_state",style:{height:h},children:[c("div",{className:"container-wrap",onClick:n,children:[e("div",{className:"as-thumb",style:{backgroundImage:`url(${d==null?void 0:d.background_url})`},children:B&&e("img",{src:B,alt:"",className:`as-thumb-character ${F==0?"lb":F==1?"mb":"rb"}`})}),e("div",{className:"as-text",children:$.map((s,m)=>e("div",{className:"as-text-wrap",onClick:()=>{i(s)},children:s},m))})]}),e("button",{className:"back-to-btn",onClick:g,children:e("img",{src:"/assets/image/back-to-img.svg",alt:""})}),!C&&c("div",{className:"text-select-btn-group",children:[!p&&e("a",{className:"next-btn",children:"\u30BF\u30C3\u30D7\u3057\u3066\u6B21\u3078\xA0\xA0\u25B6"}),p&&e("a",{className:"next-btn active",children:"\u9078\u629E\u3057\u3066\u4E0B\u3055\u3044\xA0\xA0\u25B6"})]}),C&&c("div",{className:"text-select-btn-group",children:[e("a",{href:"",className:"final-btn",children:"\u3082\u3046\u4E00\u5EA6\u898B\u308B"}),e("a",{href:"",className:"final-btn",children:"\u3053\u306E\u7269\u8A9E\u3092\u30B7\u30A7\u30A2\u3059\u308B"})]})]})]})}function _e(){const a=ae();return console.log(a),e("div",{className:"flex-center position-ref full-height full-width bg-white",children:e("div",{className:"message",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:a.state.message}})})}function ve(){return e(ue,{children:c(se,{children:[e(O,{path:"/",element:e(oe,{})}),e(O,{path:"/select",element:e(de,{})}),e(O,{path:"/synopsis",element:e(pe,{})}),e(O,{path:"/talk/:id",element:e(fe,{})}),e(O,{path:"/error",element:e(_e,{})})]})})}function be(){return e(P,{children:e(ve,{})})}re.render(e(ie.StrictMode,{children:e(be,{})}),document.getElementById("root"));
